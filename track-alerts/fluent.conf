<source>
  @type  tail
  path   /suricata/eve.json
  read_from_head true
  pos_file /tmp/eve.json.pos
  tag suricata
  <parse>
    @type json
    time_type string
    time_format %Y-%m-%dT%H:%M:%S.%6N%z
  </parse>
</source>

<filter suricata>
  @type grep
  <regexp>
    key event_type
    pattern /alert/
  </regexp>
</filter>

#<filter suricata>
#  @type parser
#  key_name alert
#  format json
#  reserve_data true
#</filter>

<match suricata>
  @type sql
  host postgres1
  port 5432
  database suricata
  adapter postgresql
  username fluent
  password test

  <table>
    table alerts
    column_mapping 'timestamp:alertdt,alert:details'
  </table>
</match>

#<match suricata>
#  @type stdout
#  <format>
#    @type csv
#    fields timestamp,event_type
#  </format>
#</match>
